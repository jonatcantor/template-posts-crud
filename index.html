<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Web site about news">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@500&family=Roboto:wght@300&display=swap" rel="stylesheet"> 
  <link rel="stylesheet" href="./css/index.css">
  <title>Template posts | Jonathan Cantor</title>
</head>
<body>
  <header class="header">
    <div class="header__lists">
      <nav>
        <ul class="stick__list">
          <li class="stick__list__element"><a href="#">Home</a></li>
          <li class="stick__list__element"><a href="#">About Us</a></li>
          <li class="stick__list__element"><a href="#">Demo Page</a></li>
          <li class="stick__list__element"><a href="#">Contact Page</a></li>
        </ul>
      </nav>
      
      <nav>
        <ul class="stick__list">
          <li class="stick__text">Subscribe:</li>
          <li class="stick__list__element"><a href="#">Posts</a></li>
          <li class="stick__list__element"><a href="#">Comments</a></li>
          <li class="stick__list__element"><a href="#">Email</a></li>
        </ul>
      </nav>
    </div>

    <div class="header__content">
      <div class="header__logo">
        <h1 class="header__title"><a href="./index.html">Web Site Name</a></h1>
        <span class="header__description"><a href="./index.html">Web Site Description</a></span>
      </div>

      <button onclick="altClassFromSelector('.header__lists', 'header__lists__open')" aria-label="Menu button" class="header__button"><svg viewBox="0 0 100 80"><rect width="100" height="20"></rect><rect y="30" width="100" height="20"></rect><rect y="60" width="100" height="20"></rect></svg></button>
    </div>

    <div class="advertise advertise--lg">
      Advertise Here
    </div>
  </header>

  <nav class="tag__list__box">
    <ul class="tag__list">
      <li class="tag__list__element"><a href="#">Advertising</a></li>
      <li class="tag__list__element"><a href="#">Entertainment</a></li>
      <li class="tag__list__element"><a href="#">Fashion</a></li>
      <li class="tag__list__element"><a href="#">Lifestyle</a></li>
      <li class="tag__list__element"><a href="#">Pictures</a></li>
      <li class="tag__list__element"><a href="#">Videos</a></li>
    </ul>
  </nav>

  <div class="wrapper">
    <main class="main">
      <article class="post">
        <img class="post__img post__img__loading" width="100%" height="auto">
        <h2 class="post__title post__title__loading"></h2>
        <p class="post__info post__info__loading"></p>
        <p class="post__excerpt post__excerpt__loading"></p>
        <a href="" class="post__link post__link__loading"></a>
      </article>

      <article class="post">
        <img class="post__img post__img__loading" width="100%" height="auto">
        <h2 class="post__title post__title__loading"></h2>
        <p class="post__info post__info__loading"></p>
        <p class="post__excerpt post__excerpt__loading"></p>
        <a href="" class="post__link post__link__loading"></a>
      </article>

      <article class="post">
        <img class="post__img post__img__loading" width="100%" height="auto">
        <h2 class="post__title post__title__loading"></h2>
        <p class="post__info post__info__loading"></p>
        <p class="post__excerpt post__excerpt__loading"></p>
        <a href="" class="post__link post__link__loading"></a>
      </article>

      <article class="post">
        <img class="post__img post__img__loading" width="100%" height="auto">
        <h2 class="post__title post__title__loading"></h2>
        <p class="post__info post__info__loading"></p>
        <p class="post__excerpt post__excerpt__loading"></p>
        <a href="" class="post__link post__link__loading"></a>
      </article>
    </main>

    <aside class="aside">
      <div class="aside__advertise">
        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>
      </div>

      <form method="" class="aside__search">
        <input type="search" value="" required name="search" aria-label="Search post" class="aside__input">
        <input type="submit" value="Search" aria-label="Submit button" class="aside__submit">
      </form>

      <section class="aside__section">
        <h3 class="aside__title">Popular Posts</h3>
        <ul class="aside__posts"></ul>
      </section>

      <section class="aside__section">
        <h3 class="aside__title">Flickr Photos</h3>
        <ul class="aside__photos">
          <li><a href="https://picsum.photos/id/500/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/500/200" alt="photo 1" width='100%' height="auto"></a></li>
          <li><a href="https://picsum.photos/id/501/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/501/200" alt="photo 2" width='100%' height="auto"></a></li>
          <li><a href="https://picsum.photos/id/502/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/502/200" alt="photo 3" width='100%' height="auto"></a></li>
          <li><a href="https://picsum.photos/id/503/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/503/200" alt="photo 4" width='100%' height="auto"></a></li>
          <li><a href="https://picsum.photos/id/504/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/504/200" alt="photo 5" width='100%' height="auto"></a></li>
          <li><a href="https://picsum.photos/id/505/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/505/200" alt="photo 6" width='100%' height="auto"></a></li>
        </ul>
      </section>

      <section class="aside__section">
        <h3 class="aside__title">Featured Video</h3>

        <video class="aside__video" autoplay playsinline muted controls loop>
          <source src="./videos/fox.mp4" type="video/mp4">
        </video>
      </section>
    </aside>
  </div>

  <footer class="footer">
    <p>Â© Copyright</p>
  </footer>

  <script src="./js/index.js"></script>
  <script>
    const main = document.querySelector('.main');

    const UPDATE_LIST = Object.freeze({
      ADD: 0,
      DELETE: 1,
    });

    const updateList = (postTarget, updateAction) => {      
      if(updateAction === UPDATE_LIST.ADD) {

      }

      else if(updateAction === UPDATE_LIST.DELETE) {
        const postDOM = document.querySelector('#p' + postTarget.postId);
        postDOM.classList.add('post--delete');
        postDOM.scrollIntoView({ block: "center", inline: "center", behavior: "smooth"});

        window.setTimeout(() => {
          postDOM.remove();
        }, 1000);
      }
    }

    const deletePost = async (postId) => {
      const response = await fetch('https://jsonplaceholder.typicode.com/posts/' + postId, { method: 'DELETE' });
      
      if(!response.ok) return { 'error': response.status };

      return { postId: postId };
    }

    const getPosts = async () => {
      const response = await fetch('https://jsonplaceholder.typicode.com/posts', { method: 'GET' });

      if(!response.ok) return { 'error' : response.status };

      const dataJson = await response.json();

      return dataJson;
    }

    (async () => {
      const posts = await getPosts();

      if(posts.error) return;

      while(main.firstChild) {
        main.removeChild(main.lastChild);
      }

      posts.forEach(post => {
        const postImgDOM = document.createElement('img');
        postImgDOM.loading = 'lazy';
        postImgDOM.className = 'post__img';
        postImgDOM.srcset = 'https://picsum.photos/id/' + post.id + '/500 500w, https://picsum.photos/id/' + post.id + '/800 800w';
        postImgDOM.sizes = '(min-width: 0px) 480px, (min-width: 768px) 768px, (min-width: 1024px) 1024px';
        postImgDOM.alt = post.title + ' image';
        postImgDOM.width = '100%';
        postImgDOM.height = 'auto';

        const postTitleDOM = document.createElement('h2');
        postTitleDOM.className = 'post__title';
        postTitleDOM.textContent = post.title;

        const postDateDOM = document.createElement('p');
        postDateDOM.className = 'post__info';
        postDateDOM.textContent = 'postinfo';

        const postTextDOM = document.createElement('p');
        postTextDOM.className = 'post__excerpt';
        postTextDOM.textContent = post.body;

        const postLinkDOM = document.createElement('a');
        postLinkDOM.className = 'post__link';
        postLinkDOM.textContent = 'Continue reading';
        postLinkDOM.href = './posts.html?id=' + post.id;

        const postDeleteButton = document.createElement('button');
        postDeleteButton.className = 'post__delete';
        postDeleteButton.textContent = 'Delete';
        postDeleteButton.onclick = async () => updateList(await deletePost(post.id), UPDATE_LIST.DELETE);

        const postDOM = document.createElement('article');
        postDOM.className = 'post';
        postDOM.id = 'p' + post.id;
        postDOM.append(postImgDOM);
        postDOM.append(postTitleDOM);
        postDOM.append(postDateDOM);
        postDOM.append(postTextDOM);
        postDOM.append(postLinkDOM);
        postDOM.append(postDeleteButton);

        main.append(postDOM);
      });

      const asidePosts = document.querySelector('.aside__posts');

      const popularPosts = posts.slice(0, 5);

      popularPosts.forEach((post) => {
        const postLiDOM = document.createElement('li');

        const postLinkDOM = document.createElement('a');
        postLinkDOM.textContent = post.title;
        postLinkDOM.href = './posts.html?id=' + post.id;

        postLiDOM.append(postLinkDOM);

        asidePosts.append(postLiDOM);
      });
    })();
  </script>
</body>
</html>
