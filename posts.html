<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@500&family=Roboto:wght@300&display=swap" rel="stylesheet"> 
  <link rel="stylesheet" href="./css/index.css">
  <title>Template posts - Post | Jonathan Cantor</title>
</head>
<body>
  <header class="header">
    <div class="header__lists">
      <nav>
        <ul class="stick__list">
          <li class="stick__list__element"><a href="#">Home</a></li>
          <li class="stick__list__element"><a href="#">About Us</a></li>
          <li class="stick__list__element"><a href="#">Demo Page</a></li>
          <li class="stick__list__element"><a href="#">Contact Page</a></li>
        </ul>
      </nav>
      
      <nav>
        <ul class="stick__list">
          <li class="stick__text">Subscribe:</li>
          <li class="stick__list__element"><a href="#">Posts</a></li>
          <li class="stick__list__element"><a href="#">Comments</a></li>
          <li class="stick__list__element"><a href="#">Email</a></li>
        </ul>
      </nav>
    </div>

    <div class="header__content">
      <div class="header__logo">
        <h1 class="header__title"><a href="./index.html">Web Site Name</a></h1>
        <span class="header__description"><a href="./index.html">Web Site Description</a></span>
      </div>

      <button onclick="altClassFromSelector('.header__lists', 'header__lists__open')" aria-label="Menu button" class="header__button"><svg viewBox="0 0 100 80"><rect width="100" height="20"></rect><rect y="30" width="100" height="20"></rect><rect y="60" width="100" height="20"></rect></svg></button>
    </div>

    <div class="advertise advertise--lg">
      Advertise Here
    </div>
  </header>

  <nav class="tag__list__box">
    <ul class="tag__list">
      <li class="tag__list__element"><a href="#">Advertising</a></li>
      <li class="tag__list__element"><a href="#">Entertainment</a></li>
      <li class="tag__list__element"><a href="#">Fashion</a></li>
      <li class="tag__list__element"><a href="#">Lifestyle</a></li>
      <li class="tag__list__element"><a href="#">Pictures</a></li>
      <li class="tag__list__element"><a href="#">Videos</a></li>
    </ul>
  </nav>

  <div class="wrapper">
    <main class="main main--single">
      <article class="post">
        <img class="post__img post__img__loading" width="100%" height="auto">
        <h2 class="post__title post__title__loading"></h2>
        <p class="post__info post__info__loading"></p>
        <p class="post__excerpt post__excerpt__loading"></p>
        <a href="" class="post__link post__link__loading"></a>
      </article>

      <section class="post__comments">
        <h3 class="post__comments__title">Post comments</h3>

        <article class="comment">
          <img class="comment__photo comment__photo__loading" width="100%" height="auto">
          <h4 class="comment__user comment__user__loading"></h4>
          <p class="comment__comment comment__comment__loading"></p>
        </article>
      </section>
    </main>

    <aside class="aside">
      <div class="aside__advertise">
        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>

        <div class="advertise advertise--sm">
          <spam>Advertise Here!</spam>
          <spam>125x125</spam>
        </div>
      </div>

      <form method="" class="aside__search">
        <label for="search">Search post</label>
        <input type="search" value="" name="search" required id="search" class="aside__input">
        <label for="submit">Submit button</label>
        <input type="submit" value="Search" id="submit" class="aside__submit">
      </form>

      <section class="aside__section">
        <h3 class="aside__title">Popular Posts</h3>
        <ul class="aside__posts"></ul>
      </section>

      <section class="aside__section">
        <h3 class="aside__title">Flickr Photos</h3>
        <ul class="aside__photos">
          <li><a href="https://picsum.photos/id/500/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/500/200" alt="photo 1"></a></li>
          <li><a href="https://picsum.photos/id/501/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/501/200" alt="photo 2"></a></li>
          <li><a href="https://picsum.photos/id/502/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/502/200" alt="photo 3"></a></li>
          <li><a href="https://picsum.photos/id/503/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/503/200" alt="photo 4"></a></li>
          <li><a href="https://picsum.photos/id/504/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/504/200" alt="photo 5"></a></li>
          <li><a href="https://picsum.photos/id/505/200" target="_blank" rel="noopener noreferrer"><img src="https://picsum.photos/id/505/200" alt="photo 6"></a></li>
        </ul>
      </section>

      <section class="aside__section">
        <h3 class="aside__title">Featured Video</h3>

        <video class="aside__video" autoplay playsinline muted controls loop>
          <source src="./videos/fox.mp4" type="video/mp4">
        </video>
      </section>
    </aside>
  </div>

  <footer class="footer">
    <p>Â© Copyright</p>
  </footer>

  <script src="./js/index.js"></script>
  <script>
    const getUrlParameter = (param) => {
      const url = window.location.href;
      let parameters = url.split('?');

      if(parameters.length != 2) return { 'error': 'parameters not found' };
      parameters = parameters[1].split('&');

      if(parameters.length != 1) return { 'error': 'parameters not valids' };

      const parameter = parameters[0].split('=');
      if(parameter[0] != param) return { 'error': 'parameters not valids' };

      return parameter[1];
    }

    const getPost = async (idPost) => {
      const response = await fetch('https://jsonplaceholder.typicode.com/posts/' + idPost, { method: 'GET' });

      if(!response.ok) return { 'error' : response.status };

      const dataJson = await response.json();

      return dataJson;
    }

    const getPosts = async () => {
      const response = await fetch('https://jsonplaceholder.typicode.com/posts', { method: 'GET' });

      if(!response.ok) return { 'error' : response.status };

      const dataJson = await response.json();

      return dataJson;
    }
    
    (async () => {
      const idPost = getUrlParameter('id');

      if(idPost.error) return;

      const post = await getPost(idPost);

      if(post.error) return;
      
      const main = document.querySelector('.main');
      main.removeChild(main.firstElementChild);

      const postImgDOM = document.createElement('img');
      postImgDOM.loading = 'lazy';
      postImgDOM.className = 'post__img';
      postImgDOM.srcset = 'https://picsum.photos/id/' + post.id + '/500 500w, https://picsum.photos/id/' + post.id + '/800 800w';
      postImgDOM.sizes = '(min-width: 0px) 480px, (min-width: 768px) 768px, (min-width: 1024px) 1024px';
      postImgDOM.alt = post.title + ' image';

      const postTitleDOM = document.createElement('h2');
      postTitleDOM.className = 'post__title';
      postTitleDOM.textContent = post.title;

      const postDateDOM = document.createElement('p');
      postDateDOM.className = 'post__info';
      postDateDOM.textContent = 'postinfo';

      const postTextDOM = document.createElement('p');
      postTextDOM.className = 'post__excerpt';
      postTextDOM.textContent = post.body;

      const postDOM = document.createElement('article');
      postDOM.className = 'post post__single';
      postDOM.append(postImgDOM);
      postDOM.append(postTitleDOM);
      postDOM.append(postDateDOM);
      postDOM.append(postTextDOM);

      main.prepend(postDOM);

      const asidePosts = document.querySelector('.aside__posts');

      const posts = await getPosts();

      if(posts.error) return;

      const popularPosts = posts.slice(0, 5);

      popularPosts.forEach((post) => {
        const postLiDOM = document.createElement('li');

        const postLinkDOM = document.createElement('a');
        postLinkDOM.textContent = post.title;
        postLinkDOM.href = './posts.html?id=' + post.id;

        postLiDOM.append(postLinkDOM);

        asidePosts.append(postLiDOM);
      });
    })();
  </script>
</body>
</html>
